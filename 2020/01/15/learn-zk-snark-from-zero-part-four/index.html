<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>从零开始学习 zk-SNARK（四）——多项式的约束 - SECBIT Blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="Maksym Petkus，翻译 & 注解：even@安比实验室（even@secbit.io）" />
  <meta name="description" content="上一篇文章中我们学习了如何将程序转换为多项式进行证明。到这里似乎已经有点晕了，本文将对协议执行进一步的约束，并对协议展开优化。" />

  <meta name="keywords" content="Blockchain, Smart Contract, Zero Knowledge Proof" />






<meta name="generator" content="Hugo 0.75.1" />


<link rel="canonical" href="https://sec-bit.github.io/blog/2020/01/15/learn-zk-snark-from-zero-part-four/" />





<link rel="icon" href="/blog/favicon.ico" />











<link rel="stylesheet" href="/blog/sass/jane.min.fa3d941d1d0e0ddc985804227feabffea55c89883eb0af34e0532a7ae9135151.css" integrity="sha256-&#43;j2UHR0ODdyYWAQif&#43;q//qVciYg&#43;sK804FMqeukTUVE=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/blog/css/custom.css">


<meta property="og:title" content="从零开始学习 zk-SNARK（四）——多项式的约束" />
<meta property="og:description" content="上一篇文章中我们学习了如何将程序转换为多项式进行证明。到这里似乎已经有点晕了，本文将对协议执行进一步的约束，并对协议展开优化。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sec-bit.github.io/blog/2020/01/15/learn-zk-snark-from-zero-part-four/" />
<meta property="article:published_time" content="2020-01-15T08:00:00+08:00" />
<meta property="article:modified_time" content="2020-12-15T19:40:44+08:00" /><meta property="og:site_name" content="SECBIT Blog" />
<meta itemprop="name" content="从零开始学习 zk-SNARK（四）——多项式的约束">
<meta itemprop="description" content="上一篇文章中我们学习了如何将程序转换为多项式进行证明。到这里似乎已经有点晕了，本文将对协议执行进一步的约束，并对协议展开优化。">
<meta itemprop="datePublished" content="2020-01-15T08:00:00+08:00" />
<meta itemprop="dateModified" content="2020-12-15T19:40:44+08:00" />
<meta itemprop="wordCount" content="9531">



<meta itemprop="keywords" content="Zero Knowledge Proof,tutorials,zkSNARKs," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="从零开始学习 zk-SNARK（四）——多项式的约束"/>
<meta name="twitter:description" content="上一篇文章中我们学习了如何将程序转换为多项式进行证明。到这里似乎已经有点晕了，本文将对协议执行进一步的约束，并对协议展开优化。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-149859278-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body,
            {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false },
                ]
            }
        );
    });
</script>

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/blog/" class="logo">SECBIT Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/categories/">分类</a>
          
        
      </li>
    <li class="mobile-menu-item">
        
        <div class="mobile-menu-parent mobile-menu-item-lang">
          <span class="mobile-submenu-open"></span>
          <a href="#">
            
            <i class="iconfont">
              <svg height="16" width="16" version="1.1" viewBox="0 0 128 128">
  <path d="m 64.719501,1.4279814 c -34.694029,0 -62.8192028,28.1251726 -62.8192028,62.8192016 0,34.694036 28.1251738,62.819207 62.8192028,62.819207 4.245691,0 8.392744,-0.42239 12.402214,-1.2253 -1.616124,-0.77296 -1.792473,-6.57213 -0.194346,-9.87848 1.779059,-3.68082 7.361625,-13.00555 1.840404,-16.134231 -5.521221,-3.12869 -3.98755,-4.53968 -7.361625,-8.15914 -3.374083,-3.61947 -1.994181,-4.16357 -2.208492,-5.09179 -0.736158,-3.19004 3.251385,-7.975096 3.435429,-8.465866 0.184043,-0.490781 0.184043,-2.331182 0.122689,-2.883308 -0.06131,-0.552125 -2.515051,-2.024446 -3.12852,-2.085791 -0.613469,-0.06133 -0.920209,0.98154 -1.77906,1.042896 -0.858856,0.06133 -4.601018,-2.269838 -5.39853,-2.883308 -0.797504,-0.61346 -1.165591,-2.085792 -2.269828,-3.190033 -1.104247,-1.104252 -1.226945,-0.24539 -2.944651,-0.920206 -1.717714,-0.674812 -7.238935,-2.69926 -11.471867,-4.416975 -4.23294,-1.717714 -4.601019,-4.125615 -4.662365,-5.827954 -0.06131,-1.702333 -2.57657,-4.171587 -3.756227,-5.950646 -1.179335,-1.77906 -1.396914,-4.232932 -1.826339,-3.680809 -0.429425,0.552114 2.208484,6.993538 1.77906,7.177582 -0.429425,0.184043 -1.349635,-1.77906 -2.576572,-3.374083 -1.226936,-1.595016 1.28829,-0.736159 -2.637915,-8.465864 -3.926198,-7.729705 1.226944,-11.671284 1.472324,-15.704806 0.24539,-4.033514 3.312738,1.472325 1.717715,-1.104238 -1.595016,-2.576571 0.122697,-7.975094 -1.104246,-9.938197 -1.226936,-1.963102 -8.220475,2.208492 -8.220475,2.208492 0.184036,-1.901758 6.134682,-5.153142 10.428966,-8.1591366 4.294277,-3.005996 6.91682,-0.674813 10.367621,0.4294236 3.450803,1.104246 3.680817,0.736167 2.515226,-0.368079 -1.165591,-1.1042446 0.49077,-1.6563686 3.190031,-1.2269356 2.699269,0.429425 3.435428,3.6808086 7.545669,3.3740746 4.110242,-0.306735 0.429425,0.797511 0.981548,1.840412 0.552123,1.042892 -0.613468,0.920202 -3.312729,2.760607 -2.699262,1.840403 0.06131,1.840403 4.846407,5.337177 4.785055,3.496773 3.312729,-2.331183 2.821952,-4.907753 -0.490777,-2.576563 3.496773,-0.552115 3.496773,-0.552115 2.944651,1.963094 2.400546,0.107972 4.547684,0.782784 2.147139,0.674814 7.967076,5.597286 7.967076,5.597286 -7.300273,3.98755 -2.699261,4.416975 -1.472325,5.337178 1.226937,0.920202 -2.515218,2.699261 -2.515218,2.699261 -1.53367,-1.53367 -1.779059,0.06131 -2.760614,0.613476 -0.981548,0.552115 -0.06131,1.963095 -0.06131,1.963095 -5.076415,0.797512 -3.926198,6.13469 -3.864852,7.422971 0.06131,1.288289 -3.251385,3.251384 -4.110242,5.091796 -0.858857,1.840405 2.208491,5.827948 0.613468,6.073336 -1.595016,0.24539 -3.190031,-6.011991 -11.778601,-3.680808 -2.589322,0.702954 -8.343174,3.680808 -5.275824,9.754153 3.06734,6.073336 8.15913,-1.717714 9.876843,-0.858857 1.717714,0.858857 -0.490778,4.72371 -0.122691,4.785055 0.368079,0.06131 4.8464,0.168662 5.09179,5.398522 0.245388,5.229868 6.809502,4.785065 8.220482,4.907755 1.410972,0.12269 6.134682,-3.864859 6.809502,-4.048894 0.674815,-0.184034 3.374076,-2.453876 9.263377,0.920195 5.889301,3.374089 8.895296,2.883308 10.919743,4.294285 2.02445,1.410987 0.61347,4.232939 2.51523,5.153134 1.90175,0.920217 9.50876,-0.306736 11.41051,2.821966 1.90176,3.1287 -7.8524,18.833491 -10.91974,20.551201 -3.06734,1.71772 -4.478321,5.64392 -7.545665,8.15913 -3.067349,2.51523 -7.361625,5.62854 -11.410522,8.03646 -3.583968,2.1311 -4.228845,5.949 -5.825333,7.15419 28.11404,-6.24545 49.13623,-31.328971 49.13623,-61.323497 0,-34.694029 -28.125171,-62.8192016 -62.819206,-62.8192016 z M 79.442753,60.382331 c -0.858857,0.245389 -2.637917,1.840405 -6.993547,-0.736166 -4.35563,-2.576564 -7.361625,-2.085794 -7.729705,-2.515218 0,0 -0.368079,-1.0429 1.533671,-1.226937 3.905098,-0.378065 8.833951,3.619464 9.938196,3.680809 1.104246,0.06131 1.656361,-1.104245 3.619464,-0.471631 1.963103,0.631953 0.490777,1.023755 -0.368079,1.269143 z M 58.891546,7.6853614 c -0.427786,-0.311152 0.354344,-0.669418 0.82058,-1.288281 0.269103,-0.357613 0.0695,-0.951289 0.406356,-1.28829 0.92021,-0.920203 5.459876,-2.208485 4.572225,0.306734 -0.887321,2.515226 -5.12434,2.760614 -5.799161,2.269837 z m 10.98109,7.9750936 c -1.533672,-0.06131 -5.14381,-0.442837 -4.478321,-1.104246 2.591952,-2.576563 -0.981548,-3.312729 -3.190039,-3.496766 -2.208485,-0.184043 -3.128687,-1.4109786 -2.02444,-1.5336776 1.104237,-0.12269 5.521213,0.06139 6.257379,0.6748206 0.736158,0.613469 4.723709,2.208485 4.969099,3.374076 0.24538,1.16559 0,2.147138 -1.533678,2.085793 z M 83.184914,15.23103 c -1.226943,0.981547 -7.400887,-3.521968 -8.588569,-4.539674 -5.153134,-4.4169746 -7.913742,-2.9446486 -8.995903,-3.6808086 -1.082485,-0.736166 -0.696897,-1.717713 0.959464,-3.190039 1.656369,-1.472325 6.318732,0.490778 9.017994,0.797512 2.699262,0.306734 5.827955,2.392527 5.889301,4.871925 0.06131,2.4792256 2.944649,4.7595296 1.717713,5.7410846 z" />
</svg>

            </i>
            语言
          </a>
        </div>
        <ul class="mobile-submenu-list">
          
            <li>
              
                <a href="https://sec-bit.github.io/blog/en/">English</a>
              
            </li>
          
            <li>
              
                <a href="https://sec-bit.github.io/blog/"><strong>中文</strong></a>
              
            </li>
          
        </ul>
      </li>

    
      <li class="mobile-menu-item">
        <a id="openSearchMobile" class="mobile-menu-item-link menu-item-search" href="#">
          <i class="iconfont">
            <svg version="1.1" viewBox="0 0 1024 1024"
  xmlns="http://www.w3.org/2000/svg" width="18" height="18"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M973.81454219 973.81454219a91.78207815 91.78207815 0 0 1-129.80999631 0l-161.97482118-161.97482118a425.48527711 425.48527711 0 0 1-230.35931791 68.16531768 428.3346319 428.3346319 0 1 1 428.3346319-428.3346319 425.48527711 425.48527711 0 0 1-68.16531768 230.35931791l162.02961656 161.97482118a91.83687354 91.83687354 0 0 1-0.05479538 129.80999631zM451.67040679 145.69361559a305.97679241 305.97679241 0 1 0 0 611.95358361 305.97679241 305.97679241 0 0 0 0-611.95358361z">
  </path>
</svg>

          </i>
        </a>
      </li>
    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/blog/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/blog/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  
    
<div class="modal-dialog">
    
    <div class="modal-content">
      <div id="closeSearch" title="Close" class="close">X</div>
      <div class="modal-header">
        <div class="modal-title">Search</div>
      </div>
      <div class="modal-body">
          <script>
            (function() {
              var cx = '013402755253274635861:4rj70y1whw3';
              var gcse = document.createElement('script');
              gcse.type = 'text/javascript';
              gcse.async = true;
              gcse.src = (document.location.protocol == 'https:' ? 'https:' :
                  'http:') +
                '//cse.google.com/cse.js?cx=' + cx;
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(gcse, s);
            })();
          </script>
          <gcse:search></gcse:search>
      </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/blog/" class="logo">
    
      SECBIT Blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://sec-bit.github.io/blog/categories/">分类</a>
          

        

      </li>
    

    
    <li class="menu-item">
        
        <a class="menu-item-link menu-parent menu-item-lang" href="#">
          
          <i class="iconfont">
            <svg height="16" width="16" version="1.1" viewBox="0 0 128 128">
  <path d="m 64.719501,1.4279814 c -34.694029,0 -62.8192028,28.1251726 -62.8192028,62.8192016 0,34.694036 28.1251738,62.819207 62.8192028,62.819207 4.245691,0 8.392744,-0.42239 12.402214,-1.2253 -1.616124,-0.77296 -1.792473,-6.57213 -0.194346,-9.87848 1.779059,-3.68082 7.361625,-13.00555 1.840404,-16.134231 -5.521221,-3.12869 -3.98755,-4.53968 -7.361625,-8.15914 -3.374083,-3.61947 -1.994181,-4.16357 -2.208492,-5.09179 -0.736158,-3.19004 3.251385,-7.975096 3.435429,-8.465866 0.184043,-0.490781 0.184043,-2.331182 0.122689,-2.883308 -0.06131,-0.552125 -2.515051,-2.024446 -3.12852,-2.085791 -0.613469,-0.06133 -0.920209,0.98154 -1.77906,1.042896 -0.858856,0.06133 -4.601018,-2.269838 -5.39853,-2.883308 -0.797504,-0.61346 -1.165591,-2.085792 -2.269828,-3.190033 -1.104247,-1.104252 -1.226945,-0.24539 -2.944651,-0.920206 -1.717714,-0.674812 -7.238935,-2.69926 -11.471867,-4.416975 -4.23294,-1.717714 -4.601019,-4.125615 -4.662365,-5.827954 -0.06131,-1.702333 -2.57657,-4.171587 -3.756227,-5.950646 -1.179335,-1.77906 -1.396914,-4.232932 -1.826339,-3.680809 -0.429425,0.552114 2.208484,6.993538 1.77906,7.177582 -0.429425,0.184043 -1.349635,-1.77906 -2.576572,-3.374083 -1.226936,-1.595016 1.28829,-0.736159 -2.637915,-8.465864 -3.926198,-7.729705 1.226944,-11.671284 1.472324,-15.704806 0.24539,-4.033514 3.312738,1.472325 1.717715,-1.104238 -1.595016,-2.576571 0.122697,-7.975094 -1.104246,-9.938197 -1.226936,-1.963102 -8.220475,2.208492 -8.220475,2.208492 0.184036,-1.901758 6.134682,-5.153142 10.428966,-8.1591366 4.294277,-3.005996 6.91682,-0.674813 10.367621,0.4294236 3.450803,1.104246 3.680817,0.736167 2.515226,-0.368079 -1.165591,-1.1042446 0.49077,-1.6563686 3.190031,-1.2269356 2.699269,0.429425 3.435428,3.6808086 7.545669,3.3740746 4.110242,-0.306735 0.429425,0.797511 0.981548,1.840412 0.552123,1.042892 -0.613468,0.920202 -3.312729,2.760607 -2.699262,1.840403 0.06131,1.840403 4.846407,5.337177 4.785055,3.496773 3.312729,-2.331183 2.821952,-4.907753 -0.490777,-2.576563 3.496773,-0.552115 3.496773,-0.552115 2.944651,1.963094 2.400546,0.107972 4.547684,0.782784 2.147139,0.674814 7.967076,5.597286 7.967076,5.597286 -7.300273,3.98755 -2.699261,4.416975 -1.472325,5.337178 1.226937,0.920202 -2.515218,2.699261 -2.515218,2.699261 -1.53367,-1.53367 -1.779059,0.06131 -2.760614,0.613476 -0.981548,0.552115 -0.06131,1.963095 -0.06131,1.963095 -5.076415,0.797512 -3.926198,6.13469 -3.864852,7.422971 0.06131,1.288289 -3.251385,3.251384 -4.110242,5.091796 -0.858857,1.840405 2.208491,5.827948 0.613468,6.073336 -1.595016,0.24539 -3.190031,-6.011991 -11.778601,-3.680808 -2.589322,0.702954 -8.343174,3.680808 -5.275824,9.754153 3.06734,6.073336 8.15913,-1.717714 9.876843,-0.858857 1.717714,0.858857 -0.490778,4.72371 -0.122691,4.785055 0.368079,0.06131 4.8464,0.168662 5.09179,5.398522 0.245388,5.229868 6.809502,4.785065 8.220482,4.907755 1.410972,0.12269 6.134682,-3.864859 6.809502,-4.048894 0.674815,-0.184034 3.374076,-2.453876 9.263377,0.920195 5.889301,3.374089 8.895296,2.883308 10.919743,4.294285 2.02445,1.410987 0.61347,4.232939 2.51523,5.153134 1.90175,0.920217 9.50876,-0.306736 11.41051,2.821966 1.90176,3.1287 -7.8524,18.833491 -10.91974,20.551201 -3.06734,1.71772 -4.478321,5.64392 -7.545665,8.15913 -3.067349,2.51523 -7.361625,5.62854 -11.410522,8.03646 -3.583968,2.1311 -4.228845,5.949 -5.825333,7.15419 28.11404,-6.24545 49.13623,-31.328971 49.13623,-61.323497 0,-34.694029 -28.125171,-62.8192016 -62.819206,-62.8192016 z M 79.442753,60.382331 c -0.858857,0.245389 -2.637917,1.840405 -6.993547,-0.736166 -4.35563,-2.576564 -7.361625,-2.085794 -7.729705,-2.515218 0,0 -0.368079,-1.0429 1.533671,-1.226937 3.905098,-0.378065 8.833951,3.619464 9.938196,3.680809 1.104246,0.06131 1.656361,-1.104245 3.619464,-0.471631 1.963103,0.631953 0.490777,1.023755 -0.368079,1.269143 z M 58.891546,7.6853614 c -0.427786,-0.311152 0.354344,-0.669418 0.82058,-1.288281 0.269103,-0.357613 0.0695,-0.951289 0.406356,-1.28829 0.92021,-0.920203 5.459876,-2.208485 4.572225,0.306734 -0.887321,2.515226 -5.12434,2.760614 -5.799161,2.269837 z m 10.98109,7.9750936 c -1.533672,-0.06131 -5.14381,-0.442837 -4.478321,-1.104246 2.591952,-2.576563 -0.981548,-3.312729 -3.190039,-3.496766 -2.208485,-0.184043 -3.128687,-1.4109786 -2.02444,-1.5336776 1.104237,-0.12269 5.521213,0.06139 6.257379,0.6748206 0.736158,0.613469 4.723709,2.208485 4.969099,3.374076 0.24538,1.16559 0,2.147138 -1.533678,2.085793 z M 83.184914,15.23103 c -1.226943,0.981547 -7.400887,-3.521968 -8.588569,-4.539674 -5.153134,-4.4169746 -7.913742,-2.9446486 -8.995903,-3.6808086 -1.082485,-0.736166 -0.696897,-1.717713 0.959464,-3.190039 1.656369,-1.472325 6.318732,0.490778 9.017994,0.797512 2.699262,0.306734 5.827955,2.392527 5.889301,4.871925 0.06131,2.4792256 2.944649,4.7595296 1.717713,5.7410846 z" />
</svg>

          </i>
          中文
        </a>
        <ul class="submenu">
          
            
              <li>
                <a href="https://sec-bit.github.io/blog/en/">English</a>
              </li>
            
          
            
          
        </ul>
      </li>
    

    
      <li class="menu-item">
        <a id="openSearch" class="menu-item-link menu-item-search" href="#">
          <i class="iconfont">
            <svg version="1.1" viewBox="0 0 1024 1024"
  xmlns="http://www.w3.org/2000/svg" width="18" height="18"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M973.81454219 973.81454219a91.78207815 91.78207815 0 0 1-129.80999631 0l-161.97482118-161.97482118a425.48527711 425.48527711 0 0 1-230.35931791 68.16531768 428.3346319 428.3346319 0 1 1 428.3346319-428.3346319 425.48527711 425.48527711 0 0 1-68.16531768 230.35931791l162.02961656 161.97482118a91.83687354 91.83687354 0 0 1-0.05479538 129.80999631zM451.67040679 145.69361559a305.97679241 305.97679241 0 1 0 0 611.95358361 305.97679241 305.97679241 0 0 0 0-611.95358361z">
  </path>
</svg>

          </i>
        </a>
      </li>
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">从零开始学习 zk-SNARK（四）——多项式的约束</h1>
      
      <div class="post-meta">
        <time datetime="2020-01-15" class="post-time">
          2020-01-15
        </time>
        <div class="post-category">
            <a href="https://sec-bit.github.io/blog/categories/zero-knowledge-proof/"> Zero Knowledge Proof </a>
            <a href="https://sec-bit.github.io/blog/categories/zksnarks/"> zkSNARKs </a>
            
          </div>
        <span class="more-meta"> 约 9531 字 </span>
          <span class="more-meta"> 预计阅读 20 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    
  </div>
</div>

    
    <div class="post-content">
      <blockquote>
<p>even@安比实验室: 上一篇文章中我们学习了如何将程序转换为多项式进行证明。到这里似乎已经有点晕了，本文将对协议执行进一步的约束，并对协议展开优化。</p>
</blockquote>
<p>作者：Maksym Petkus</p>
<p>翻译 &amp; 注解：even@安比实验室（even@secbit.io）</p>
<p>校对：valuka@安比实验室</p>
<p>本系列文章已获作者中文翻译授权。</p>
<h2 id="结构性质">结构性质</h2>
<p>上文中的修改额外带来了一些其它有用的性质。</p>
<h3 id="静态系数">静态系数</h3>
<p>在上文的构造中，我们通过对 <em>未赋值的变量多项式</em> 的计算得到0 或者 1 ，以此表示在运算中是否要用到这个变量。自然地想，我们也可以使用其它系数值，包括负数值，因为我们可以<em>插值</em> 计算出经过任何必要的点（前提是没有两个计算使用了同一个 <em>x</em>）的多项式。如下是这种运算的一些例子：</p>
<p><span class="math inline">\(\textcolor{green}{2a} \times \textcolor{blue}{1b} = \textcolor{red}{3r}\)</span></p>
<p><span class="math inline">\(\textcolor{green}{-3a} \times \textcolor{blue}{1b} = \textcolor{red}{-2r}\)</span></p>
<p>现在我们的程序就可以使用静态系数了，例如：</p>
<pre class="pseudocode"><code>Algorithm 2: Constant coefficients
————————————————————————————————————————————————————————————

function calc(w, a, b)
    if w then
        return 3a × b
    else 
        return 5a × 2b
    end if
end function</code></pre>
<p>在 setup 阶段这些系数类似于 0 或者 1 将被“硬编码”进去，之后就不能再修改了。现在我们将运算形式修改为：</p>
<p><span class="math inline">\(\textcolor{green}{c_a \cdot a} \times \textcolor{blue}{c_b \cdot b} = \textcolor{red}{c_r \cdot r}\)</span></p>
<p>或者更正式得用参数 v<sub>n</sub> ∈ {v<sub>1</sub>, v<sub>2</sub>, …, v<sub>n</sub>} 表示：</p>
<p><span class="math inline">\(\textcolor{green}{c_l \cdot v_l} \times \textcolor{blue}{c_r \cdot v_r} = \textcolor{red}{c_o \cdot v_o}\)</span></p>
<p>其中下标 <em>l</em> ，<em>r</em> 和 <em>o</em> 表示变量在运算中的位置。</p>
<p><em>注意：在不同的运算和操作数/输出中，同一个变量的常量系数可以是不同的。</em></p>
<h3 id="没有成本的做加法">没有成本的做加法</h3>
<p>看一下这个新结构，很显然在多项式的表示中，每一个不同 x 所要代表的操作数都是所有<em>操作数变量多项式</em> 的总和，其中只有一个被用到的变量是非零值而其它都为 0，下图就很好得表达了这个意思：</p>
<p><img src="./img/4/1*HeUXxV8-H5MVbhdT8haqqw.png" /></p>
<p>我们可以利用这一个结构，加任何数量必要的<em>变量</em> 到每一个运算的操作符/输出中。例如在第一个运算中，我们可以首先做加法 <em>a+c</em>，然后就只需要用别的操作数与之相乘了，即 (<em>a</em>+ <em>c</em>) × <em>b</em> = <em>r</em>，可以表示为下图：</p>
<p><img src="./img/4/1*RpLBxan0och5LvpuE5KJVw.png" /></p>
<p>因而也可以将这些变量中任意个，对它们先乘以任意的系数再一并加入到一起作为单个操作数中，以此来根据相应程序的需要构造一个操作数值。这个特性实际上就允许将运算结构改为：</p>
<p><span class="math inline">\(\textcolor{green}{(c_{1,a} \cdot a + c_{1,b} \cdot b + …) } \times \textcolor{blue}{(c_{r,a} \cdot a + c_{r,b}\cdot b + …)} = \textcolor{red}{(c_{o,a} \cdot a + c_{o,b} \cdot b + …)}\)</span></p>
<p>或者更正式一些用变量 <em>vᵢ</em> ∈ {<em>v</em>₁<em>, v</em>₂<em>, …, vₙ</em>} 和操作数变量系数 <span class="math inline">\(c_{l,i} \in \{c_{l,1}, c_{l,2},……,c_{l,n}\}, c_{r,i} \in \{c_{r,1}, c_{r,2},……,c_{r,n}\},c_{o,i} \in \{c_{o,1}, c_{o,2},……,c_{o,n}\},\)</span></p>
<p>这个结构就是：</p>
<p><span class="math inline">\(\textcolor{green}{\sum_{i=1}^n {c_{l,i} \cdot v_i}} \times \textcolor{blue}{\sum_{i=1}^n {c_{r,i} \cdot v_i}} = \textcolor{red}{\sum_{i=1}^n {c_{o,i} \cdot v_i}}\)</span></p>
<p><em>注意 ：每一个运算的操作数都有自己的一组系数 c。</em></p>
<blockquote>
<p>even@安比实验室：乘法运算是关键，而加法运算都可以被合并到一个更大的乘法运算里面。</p>
</blockquote>
<h3 id="加法减法和除法">加法，减法和除法</h3>
<p>到目前为止，我们一直专注于乘法操作。但是为了能够执行通用计算，真实环境下的程序也需要加法，加法和除法。</p>
<p><strong>加法</strong> 在前面的章节中，我们已经确定了可以在单个操作数的内容中将变量加起来，然后和另一个操作数相乘，即(3<em>a</em> + <em>b</em>) × <em>d</em> = <em>r</em> ，但是如果我们只是想做加法，没有乘法，例如一个程序中需要做 a + b 的计算，我们可以按照下面的方式来表示： <em>(a+b) × 1 = r​</em></p>
<blockquote>
<p><span class="citation" data-cites="Maksym">@Maksym</span>（作者）：因为我们的结构中对于每一个操作数我们既需要常量系数也需要变量 (c ⋅ v) ，1 这个值可以表示为 c<em>₁</em> ⋅ v<em>₁</em>，其中 c<em>₁</em> = <em>1</em> 可以被“硬编码”到对应的多项式中， v<em>₁</em> 是一个变量可以给它分配任何值，那么我们就必须通过一些约束来限制 v<em>₁</em> 的值，这个在后面的章节中将会讲到。</p>
</blockquote>
<p><strong>减法</strong> 减法与加法几乎一致，唯一的不同就是负系数， a-b也就是：</p>
<p><span class="math inline">\(\textcolor{green}{(a+-1 \cdot b)} \times \textcolor{blue}{1} = \textcolor{red}{r}\)</span></p>
<p><strong>除法</strong> 如果我们检查除法运算</p>
<p><span class="math inline">\(\frac{factor}{divisor} = result\)</span></p>
<p>可以看到除法的结果是就是我们要得到一个结果值使其乘以 divisor 能够得到 factor。所以我们也可以用乘法来表示出同一个意思：<em>divisor × result = factor</em>。这样就是说如果我们想要去证明除法运算 <em>a / b= r</em>，我们就可以把它表示为：</p>
<p><span class="math inline">\(\textcolor{green}{b} \times \textcolor{blue}{r} = \textcolor{red}{a}\)</span></p>
<blockquote>
<p><span class="citation" data-cites="Maksym">@Maksym</span>（作者）：运算的结构也称为 “约束” ，因为多项式结构代表的运算，并非是为了计算出结果，而是在 prover已经知晓的变量赋值的情况下，检验这个运算的过程是否正确。换句话说，即约束 prover 必须提供一致的值，无论这些值是什么。</p>
<p>所有的算术计算（加减乘除）都已经有了，于是运算结构不再需要修改。</p>
</blockquote>
<blockquote>
<p>even@安比实验室: 约束和运算有一定的关联性。算术电路的目的是为了实现「计算的验证」，而非「计算的过程」。</p>
<p>上一篇文章中，我们提出了一种方法：把构造多项式的工作交给 setup 环节，prover 只要填上对应的数值就可以了。 这个方法不仅解决了同一个操作数运算符中不一致的问题，同时还带来了额外的便利：</p>
<p>1）允许执行计算的表达式中包含静态系数。</p>
<p>2）虽然l(x)·r(x)=o(x)的关系中只有乘法，但利用这个方法也可以轻松的执行加法操作，继而也就解决了减法和除法的问题。</p>
</blockquote>
<h2 id="计算示例">计算示例</h2>
<p>有了一组通用的运算结构，我们就可以将我们原始的程序（上一篇文章中的例子）转换成一组运算，然后再转换成多项式的形式。我们先来想一下算法的数学形式（用变量 <em>v</em> 表示运算结果）：</p>
<p>$ w (a b) + (1 - w) (a+b) = v$</p>
<p>这里有三个乘法，但是由于运算结构只支持一个乘法操作，所以这里至少就要做三次运算。但是，我们可以将它简化为:</p>
<p><span class="math inline">\(w \times (a \times b) + a + b -w \times (a + b) = v\)</span></p>
<p><span class="math inline">\(w \times (a \times b - a - b) = v -a- b\)</span></p>
<p>现在要包含同样的关系只需要两个乘法。这种运算的完整形式就是：</p>
<p>$1:  =  $</p>
<p><span class="math inline">\(2: \qquad \textcolor{green}{1 \cdot w} \times \textcolor{blue}{1 \cdot m + -1 \cdot a + -1 \cdot b} = \textcolor{red}{1 \cdot v + -1 \cdot a + -1 \cdot b}\)</span></p>
<p>我们还可以再增加一条约束使 <em>w</em> 必须为二进制数，否则 prover 就可以代入任何值去执行一个错误的运算了：</p>
<p>$3：   =  $</p>
<p>要了解为什么 <em>w</em> 只能为 0 或者 1，我们可以把等式表示为 <em>w</em>² – <em>w</em> = 0，也就是 <em>(w – 0)(w – 1) = 0</em> 这里 0 和 1 是唯一解。</p>
<p>现在一共有 5 个变量，以及 2 个左操作符， 4 个右操作符和 5 个输出。操作符多项式为：</p>
<p><span class="math inline">\(\textcolor{green}{L(x) = a \cdot l_a(x) + w \cdot l_w(x)}\)</span></p>
<p><span class="math inline">\(\textcolor{blue}{R(x) = m \cdot r_m(x) + a \cdot r_a(x) + b \cdot r_b(x)}\)</span></p>
<p><span class="math inline">\(\textcolor{red}{O(x) = m \cdot o_m(x) + v \cdot o_v(x) + a \cdot o_a(x) + b \cdot o_b(x)}\)</span></p>
<p>在三次运算中必须为每个*变量多项式 都分别算出一个对应的系数或者如果这个多项式在计算的操作数或者输出中没有被用到的话系数就置为 0。</p>
<p><img src="./img/4/eq1.png" /></p>
<p>结果因式多项式就是 <em>t(x) = (x – 1)(x –2)(x –3)</em>，它必须确保这三个运算都能被正确计算。</p>
<p>接下来，我们利用多项式插值法来找到每个变量多项式：</p>
<p><img src="./img/4/eq2.png" /></p>
<p>绘制出来就是：</p>
<p><img src="./img/4/1*YoNx3JunyKJh8kFad6qtpQ.png" /></p>
<p>我们准备通过多项式去证明计算，首先，选择函数的输入值，例如： <em>w</em> <em>= 1</em>, <em>a</em> <em>= 3</em>, <em>b</em>= 2。其次，计算过程中的中间变量值为：</p>
<p><em>m=a × b =6</em></p>
<p><em>v = w(m-a-b)+a+b=6</em></p>
<p>然后，我们把所有计算结果中的值赋值到 <em>变量多项式</em> 中，然后相加得到操作数或者输出多项式的形式：</p>
<p><span class="math inline">\(\textcolor{green}{L(x)}=\textcolor{green}{3 \cdot l_a(x) +1 \cdot l_w(x)} = x^2 -5x+7\)</span></p>
<p><span class="math inline">\(\textcolor{blue}{R(x)}=\textcolor{blue}{6 \cdot r_m(x) + 3 \cdot r_a(x) + 2 \cdot r_b(x) + 1 \cdot r_w(x)} = \frac{1}{2}x^2 -2 \frac{1}{2}x +4\)</span></p>
<p><span class="math inline">\(\textcolor{red}{O(x)}=\textcolor{red}{6 \cdot o_m(x) + 6 \cdot o_v(x) + 3 \cdot o_a(x)+ 2 \cdot o_b(x) + 1 \cdot o_w(x)}= 2 \frac{1}{2}x^2 + 12 \frac{1}{2}x +16\)</span></p>
<p>在图中就表示为：</p>
<p><img src="./img/4/1*XwRYLT4_4KRPTqQKg2jqfQ.png" /></p>
<p>把他们相加成对应运算中的操作数和输出值：</p>
<p><img src="./img/4/1*8xEajzq2MlB9i7O8PQ829Q.png" /></p>
<p>我们需要去证明 <em>L</em>(<em>x</em>) × <em>R</em>(<em>x</em>) – <em>O</em>(<em>x</em>) = <em>t</em>(<em>x</em>)<em>h</em>(<em>x</em>)，因而我们先找出 <em>h</em>(<em>x</em>)：</p>
<p><span class="math inline">\(h(x) = \frac{L(x) \times R(x) - O(x)}{t(x)} = \frac{\frac{1}{2}x^4 - 5x^3 + \frac{35}{2}x^2 -25x +12}{(x-1)(x-2)(x-3)} = \frac{1}{2}x - 2\)</span></p>
<p>以图的形式表示为：</p>
<p><img src="./img/4/1*z4sW_cYeeGZS_8AAJzfoKQ.png" /></p>
<p>这里很明显多项式 <em>L</em>(<em>x</em>) × <em>R</em>(<em>x</em>) – <em>O</em>(<em>x</em>) 的解为 <em>x</em>= 1， <em>x</em>= 2 和 <em>x</em>= 3，因而 <em>t(x)</em> 是它的因式，假如使用了和它不一致的变量值，情况就不是这样了。</p>
<p>这就是一组能够正确计算的变量值，如何在多项式层面上证明出来的。下面 prover 还要再继续处理协议的密码学部分。</p>
<h2 id="可验证计算协议">可验证计算协议</h2>
<p>我们基于前文中<strong>多项式知识协议</strong> 做了很多重要的修改使它变得更通用，我们再来看一下它现在的定义。假定函数 <em>f</em>(<em>) 是要证明的问题中的计算结果，其中操作数的数量为 </em>d* ，变量的数量 <em>n</em> ，以及它们对应的系数为：</p>
<p><span class="math inline">\(\{c_{L,i,j},c_{R,i,j},c_{o,i,j}\}_{i \in {1,…,d}, j \in {i,…,d}}\)</span></p>
<ul>
<li><p>Setup</p>
<ul>
<li><p>为左操作数 <span class="math inline">\(\{l_i(x)\}_{i \in \{1,…,n\}}\)</span> 构造<em>变量多项式</em> 然后对于所有 <span class="math inline">\(j \in \{1,…,d\}\)</span> 的运算都算出其对应的系数，即 <span class="math inline">\(l_i(j) = c_{L,i,j}\)</span>，对右操作数和输出也做同样的事情。</p></li>
<li><p>随机抽取 <em>s</em>，<span class="math inline">\(α\)</span></p></li>
<li><p>计算 <em>t(x)= (x-1)(x-2)…(x-d)</em> 及其结果 <span class="math inline">\(g^{t(s)}\)</span></p></li>
<li><p>计算 <em>proving key</em>：</p>
<p><span class="math inline">\((\{g^{s^k}\}_{k \in[d]},\{g^{l_i(s)}, g^{r_i(s)}, g^{o_i(s)},g^{αl_i(s)},g^{αr_i(s)},g^{αo_i(s)}\}_{i \in \{1,……,n\}})\)</span></p></li>
<li><p>计算 <em>verification key</em>：</p>
<p><span class="math inline">\((g^{t(s)},g^α)\)</span></p></li>
</ul></li>
<li><p>Proving</p>
<ul>
<li><p>计算函数 <em>f(*)</em> 以此计算相应的变量 <span class="math inline">\(\{v_i\}_{i \in \{1,…,n\}}\)</span></p></li>
<li><p>计算 <span class="math inline">\(h(x) = \frac{L(x) \times R(x) - O(x)}{t(x)}\)</span>，其中 <span class="math inline">\(L(x) = \sum_{i=1}^n {v_i \cdot l_i(x)}\)</span>，<span class="math inline">\(R(x)\)</span>, <span class="math inline">\(O(x)\)</span> 与之相似</p></li>
<li><p>给变量赋值并对操作数多项式求和：</p>
<p><span class="math inline">\(g^{L(s)} = (g^{l_1(s)})^{v_1}…(g^{l_n(s)})^{v_n},g^{R(s)} = \prod_{i=1}^n{(g^{r_i(s)})^{v_i}}, g^{O(s)} = \prod_{i=1}^n{(g^{o_i(s)})^{v_i}}\)</span></p></li>
<li><p>对变换后的多项式赋值：</p>
<p><span class="math inline">\(g^{αL(s)} = \prod_{i=1}^n{(g^{αl_i(s)})^{v_i}},g^{αR(s)} = \prod_{i=1}^n{(g^{αr_i(s)})^{v_i}}, g^{αO(s)} = \prod_{i=1}^n{(g^{αo_i(s)})^{v_i}}\)</span></p></li>
<li><p>使用 s 的幂加密值：<span class="math inline">\(\{g^{s^k}\}_{k \in [d]}\)</span> 计算加密值 <span class="math inline">\(g^{h(s)}\)</span></p></li>
<li><p>生成证明：<span class="math inline">\(\{g^{L(s)},g^{R(s)},g^{O(s)},g^{αL(s)},g^{αR(s)},g^{αO(s)},g^{h(s)}\}\)</span></p></li>
</ul></li>
<li><p>Verification</p>
<ul>
<li><p>解析证明为 <span class="math inline">\(\{g^L,g^R,g^O,g^{L&#39;},g^{R&#39;},g^{O&#39;},g^{h}\}\)</span></p></li>
<li><p>检查可变多项式约束：</p>
<p><span class="math inline">\(e(g^L,g^α) = e(g^{L&#39;},g), e(g^R,g^α) = e(g^{R&#39;},g), e(g^O,g^α)=e(g^{O&#39;},g)\)</span></p></li>
<li><p>验证计算有效性：</p>
<p><span class="math inline">\(e(g^L,g^R) = e(g^t,g^h) \cdot e(g^O,g)\)</span></p></li>
</ul></li>
</ul>
<p><em>注意：使用符号 ∏ 来表示多个元素连乘，即： <span class="math inline">\(\prod_{i=1}^n{v_i} = v_1 \cdot v_2 \cdot … \cdot v_n\)</span></em></p>
<p>对于 <em>i ∈ {1, …, n}</em> 所有变量多项式 {<em>lᵢ</em>(<em>x</em>)<em>, rᵢ</em>(<em>x</em>)<em>, oᵢ</em>(<em>x</em>)} 和目标多项式 <em>t(x)</em> 的设置被称为一个<em>二元算术程序</em> (QAP，在[<a href="#8bfc">Gen+12</a>] 中有介绍)。</p>
<p>虽然协议足够健壮，可以进行常规的计算验证，但这里依然还有两个安全考虑需要去解决。</p>
<h3 id="操作数和输出的不可替代性">操作数和输出的不可替代性</h3>
<p>因为在 <em>变量多项式约束检查</em> 中的所有操作数上我们使用了同一个 <em>α</em>，所以就没有办法阻止 prover 做下面的欺骗行为：</p>
<ul>
<li>使用其它的操作数中的可变多项式，即 <em>L</em>′(<em>s</em>) = <em>o</em>₁(<em>s</em>) + <em>r</em>₁(<em>s</em>) + <em>r</em>₁(<em>s</em>) + <em>…</em></li>
<li>完全交换 <em>操作数多项式</em>， 也就是把 <em>O</em>(<em>s</em>) 和 <em>L</em>(<em>s</em>) 换成 <em>O(s) × R(s) = L(s)</em></li>
<li>复用相同的操作数多项式，即 <em>L(s) × L(s) = O(s)</em></li>
</ul>
<p>可交换性就是指 prover 可以修改计算过程，并有效证明一些其它无关的计算结果。防止这种行为的一个很显然的方式就是在不同的操作数上使用不同的 <em>α<sub>s</sub></em> ，具体协议就可以修改为：</p>
<ul>
<li><p>Setup</p>
<p>…</p>
<ul>
<li>选择随机数 <span class="math inline">\(α_l\)</span>，<span class="math inline">\(α_r\)</span>，<span class="math inline">\(α_o\)</span> 来代替 <span class="math inline">\(α\)</span></li>
<li>计算其对应的“变换” <span class="math inline">\(\{g^{α_ll_i(s)},g^{α_rr_i(s)},g^{α_oo_i(s)}\}_{i \in \{1…n\}}\)</span></li>
<li>proving key：<span class="math inline">\((\{g^{s^k}\}_{k \in [d]},\{g^{l_i(s)}, g^{r_i(s)}, g^{o_i(s)}, g^{α_ll_i(s)}, g^{α_rr_i(s)}, g^{α_oo_i(s)}\}_{i \in \{i…n\}})\)</span></li>
<li>verfication key：<span class="math inline">\((g^{t(s)},g^{α_l},g^{α_r},g^{α_o})\)</span></li>
</ul></li>
<li><p>Proving</p>
<p>…</p>
<ul>
<li>为 “变换”的多项式赋值：<span class="math inline">\(g^{α_lL(s)} = \prod_{i=1}^n{(g^{α_ll_i(s)})^{v_i}}, g^{α_lR(s)} = \prod_{i=1}^n{(g^{α_rr_i(s)})^{v_i}}, g^{α_oO(s)} = \prod_{i=1}^n{(g^{α_oo_i(s)})^{v_i}}\)</span></li>
<li>设置证明：<span class="math inline">\((g^{L(s)},g^{R(s)},g^{O(s)},g^{α_lL(s)},g^{α_rR(s)},g^{α_oO(s)},g^{h(s)})\)</span></li>
</ul></li>
<li><p>Verification</p>
<p>…</p>
<ul>
<li>可变多项式约束验证：<span class="math inline">\(e(g^L,g^{α_l}) = e(g^{L&#39;},g),e(g^R,g^{α_r}) = e(g^{R&#39;},g),e(g^O,g^{α_o}) = e(g^{O&#39;},g)\)</span></li>
</ul></li>
</ul>
<p>这样就不能在一个操作数中使用其它操作数的变量多项式了，因为 prover 没有办法去获知 <span class="math inline">\(α_l, α_r, α_o\)</span> 来满足 <span class="math inline">\(α_s\)</span> 变换关系。</p>
<blockquote>
<p>even@安比实验室: 这里通过对l(x),r(x)和o(x) 进行分开 KEA 检查，就解决了上篇文章中提出的第二个缺陷问题——由于 prover 生成的证明中只有计算结果，左操作数，右操作数，输出在计算中混用也不会被发现。</p>
<p>同样下面一节也解决了上篇文章中提出的第三个缺陷问题——由于左操作数，右操作数，输出是分开表示的，互相之间的关系无法进行约束。</p>
</blockquote>
<h3 id="跨操作数的变量一致性">跨操作数的变量一致性</h3>
<p>对于任意的变量 vᵢ ，我们都必须将它的值 <em>分配</em> 到每个相应操作数中的一个与之对应的<em>变量多项式</em> 上，即：</p>
<p><span class="math inline">\((g^{l_i(s)})^{v_i}, (g^{r_i(s)})^{v_i},(g^{o_i(s)})^{v_i}\)</span></p>
<p>因为每一个<em>操作数运算符</em> 的有效性是分开校验的，并不强制要求我们在对应的<em>变量多项式</em> 中使用相同的变量值。这就意味着在左操作数中变量 <em>v</em>₁ 的值可以与右操作数或输出中的变量值 <em>v</em>₁不同。</p>
<p>我们可以通过熟悉的限制多项式的方法（也就是限制变量多项式的方法）在操作数之间强制变量值相等。如果我们能够在所有的操作数之间创造一个作为“变换的校验和”的变量多项式，那么就可以限制 prover 使其只能够赋予相同的值。verifier 可以将这些每个变量的多项式加起来，即：</p>
<p><span class="math inline">\(g^{l_i(s)+r_i(s)+o_i(s)}\)</span></p>
<p>然后乘以一个额外的随机数 <em>β</em>，即</p>
<p><span class="math inline">\(g^{β(l_i(s)+r_i(s)+o_i(s))}\)</span></p>
<p>提供这些变换后的多项式给 prover，与变量多项式一起给它赋上变量值：</p>
<p><span class="math inline">\((g^{l_i(s)})^{v_{L,i}},(g^{r_i(s)})^{v_{R,i}}, (g^{o_i(s)})^{v_{O,i}}, (g^{β(l_i(s)+r_i(s)+o_i(s))})^{v_{β,i}}\)</span></p>
<p>然后加密 <em>β</em> 并把 <span class="math inline">\(g^β\)</span> 加到 <em>verification key</em> 中。现在如果所有的 <em>vᵢ</em> 值相同，即,</p>
<p><span class="math inline">\(v_{L,i} = v_{R,i} = v_{o,i} = v_{β,i} \quad 其中 i \in \{1,…,n\}\)</span></p>
<p>等式就满足：</p>
<p><span class="math inline">\(e(g^{v_{L,i} \cdot l_i(s)} \cdot g^{v_{R,i} \cdot r_i(s)} \cdot g^{v_{o,i} \cdot o_i(s)},g^β)=e(g^{v_{β,i} \cdot β(l_i(s)+r_i(s)+o_i(s))},g)\)</span></p>
<p>尽管这个一致性校验很有用，但还是存在一定的概率 <em>l</em>(<em>s</em>)<em>, r</em>(<em>s</em>)<em>, o</em>(<em>s</em>) 中至少有两项要么计算值相同要么一个多项式可以被另一个整除等情况，这就允许 prover 去分解 <span class="math inline">\(v_{L,i},v_{R,i},v_{O,i},v_{β,i}\)</span> 这些值的关系，使得即使有至少两个不相等的值也依然能够保持等式成立，从而使校验无效：</p>
<p><span class="math inline">\((v_{L,i} \cdot l_i(s) + v_{R,i} \cdot r_i(s) + v_{O,i} \cdot o_i(s)) \cdot β = v_{β,i} \cdot β \cdot (l_i(s) + r_i(s) + o_i(s))\)</span></p>
<p>例如，一个以 <em>l</em>(<em>x</em>) = <em>r</em>(<em>x</em>) 为例的单个运算。我们用 <em>w</em> 来表示这两个值同时 <em>y</em> = <em>o</em>(<em>s</em>)。这个等式看起来就是：</p>
<p><span class="math inline">\(β(v_Lw + v_Rw+v_Oy) = v_β \cdot β(w+w+y)\)</span></p>
<p>对于任意的 <span class="math inline">\(v_R\)</span> 和 <span class="math inline">\(v_O\)</span>，这种形式可以令 <span class="math inline">\(v_β = v_o\)</span>，<span class="math inline">\(v_L = 2v_o -v_R\)</span>，也就变换成：</p>
<p><span class="math inline">\(β(2v_ow - v_Rw + v_Rw + v_oy) = v_o \cdot β(2w+y)\)</span></p>
<p>因而这样一个一致性策略是无效的。缓解这种情况的一种方法是对每个操作数都使用不同的 β，确保操作数的<em>变量多项式</em> 中包含无法预测的值。以下就是修改后的协议：</p>
<ul>
<li><p>Setup</p>
<ul>
<li><p>… 随机数 <span class="math inline">\(β_l\)</span>， <span class="math inline">\(β_r\)</span>， <span class="math inline">\(β_o\)</span></p></li>
<li><p>对<em>变量一致性多项式</em> 进行计算，加密并添加到 proving key中：</p>
<p><span class="math inline">\({g^{β_ll_i(s)+ β_rr_i(s)+ β_oo_i(s)}}_{i \in \{1,…,n\}}\)</span></p></li>
<li><p>对 <span class="math inline">\(β_s\)</span> 加密并将其加到 <em>verification key</em> 中：<span class="math inline">\((g^{β_l},g^{β_r},g^{β_o})\)</span></p></li>
</ul></li>
<li><p>Proving</p>
<ul>
<li><p>…将变量值赋给<em>变量一致性多项式</em>：</p>
<p><span class="math inline">\(g^{z_i(s)} = (g^{β_ll_i(s)+ β_rr_i(s)+ β_oo_i(s)})^{v_i} \quad for \quad i \in \{1,…,n\}\)</span></p></li>
<li><p>增加分配的多项式到加密空间中:</p>
<p><span class="math inline">\(g^{Z(s)} = \prod_{i=1}^n{g^{z_i(s)}} = g^{β_lL(s) + β_rR(s)+ β_oO(s)}\)</span></p></li>
<li><p>再在证明中加入：<span class="math inline">\(g^{Z(s)}\)</span></p></li>
</ul></li>
<li><p>Verification</p>
<ul>
<li><p>…校验提供的<em>操作数多项式</em> 和 “校验和”多项式之间的一致性：</p>
<p><span class="math inline">\(e(g^L,g^{β_l}) \cdot e(g^R,g^{β_r}) \cdot e(g^O,g^{β_o}) = e(g^Z,g)\)</span></p>
<p>这相当于：</p>
<p><span class="math inline">\(e(g,g)^{β_lL + β_rR + β_oO} =e(g,g)^Z\)</span></p></li>
</ul></li>
</ul>
<p>这个构造中同一个变量值就无法乱用了，因为不同的 <em>β<sub>s</sub></em> 使得相同多项式无法兼容，但是这里还存在与 <strong>remark 4.1</strong> 相同的缺陷，由于<em>g<sup>β<sub>l</sub></sup></em> ，<em>g<sup>β<sub>r </sub></sup></em>， <em>g<sup>β<sub>o </sub></sup></em>是公开可见的，攻击者可以修改任意变量多项式的零索引系数，因为它并不依赖于 <em>s</em>，即，<em>g<sup>β<sub>l</sub>s<sup>0</sup></sup>= g<sup>β<sub>l</sub></sup></em>。</p>
<blockquote>
<p>even@安比实验室: 回忆一下，上文中我们提出了在 setup 阶段设置数学表达式的约束关系来解决了一些问题，但这里似乎有引入了一个问题：如果保证 prover 构造的证明是用遵循这些约束关系计算出来的呢？</p>
<p>KEA 其实已经解决了这个问题，但似乎并不完美，这就是我们下面要讨论的变量延展性问题。</p>
</blockquote>
<h3 id="变量非延展性和变量一致性多项式">变量非延展性和变量一致性多项式</h3>
<p><strong>变量多项式的延展性</strong></p>
<p>举一个 <strong>remark 4.1</strong> 有关的例子，看一下下面的两个运算：</p>
<p><span class="math inline">\(\textcolor{green}{a} \times \textcolor{blue}{1} = \textcolor{red}{b}\)</span></p>
<p><span class="math inline">\(\textcolor{green}{3a} \times \textcolor{blue}{1} =\textcolor{red}{c}\)</span></p>
<p>预期的结果 <em>b = a</em> 和 <em>c = 3a</em> , 再进一步就是 <em>c = 3b</em>。这就是说<em>左操作数的变量</em> 多项式的计算结果为 l<sub>a</sub>(1) = 1 和 l<sub>a</sub>(2) = 3。先不管 l<sub>a</sub>(<em>x</em>) 的形式， prover 都可以不按照上述的比例用另一个修改了的多项式 <em>lₐ</em>′(x) = al<sub>a</sub>(x) + 1 来给 <em>a</em> 赋值。这样运算就变成了 l<sub>a</sub>′(1) = a+ 1 和 l<sub>a</sub>′(2) = 3<em>a</em>+ 1, 结果也就是 <em>b = a + 1</em> 和 <em>c = 3a + 1</em>，其中 <em>c≠3b</em>，这意味着 <em>a</em> 的取值的实际意义在不同运算中是不一样的。</p>
<p>但是因为 prover 已经拿到了 <em>g<sup>α<sub>l</sub></sup></em> 和 <em>g<sup>β<sub>l</sub></sup></em> ，所以他依然能够通过正确的操作符多项式* 和<em>变量值一致性</em> 的校验：</p>
<ul>
<li><p>…Proving：</p>
<ul>
<li><p>用分配不成比例的变量 <em>a</em> 来建立左操作数多项式： <span class="math inline">\(L(x) = a \cdot l_a(x) +1\)</span></p></li>
<li><p>按照常规的方式构造右操作数多项式和输出多项式： <span class="math inline">\(R(x) = r_1(x), O(x)=b \cdot o_b(x) + c \cdot o_c(x)\)</span></p></li>
<li><p>计算除数：<span class="math inline">\(h(x) = \frac{L(x) \cdot R(x) - O(x)}{t(x)}\)</span></p></li>
<li><p>计算加密值：<span class="math inline">\(g^{L(s)} = (g^{l_a(s)})^a \cdot g^1\)</span>，并按照常规方式计算 <span class="math inline">\(g^{R(s)},g^{O(s)}\)</span></p></li>
<li><p>计算 α-变换的加密值：<span class="math inline">\(g^{αL(s)} = (g^{αl_a(s)})^a \cdot g^α\)</span>，并按照常规方式计算 <span class="math inline">\(g^{αR(s)},g^{αO(s)}\)</span></p></li>
<li><p>计算变量一致性多项式：</p>
<p><span class="math inline">\(g^{Z(s)} = \prod_{i \in \{1,a,b,c\}}{(g^{β_ll_i(s)+β_rr_i(s)+β_oO_i(s)})^i \cdot g^{β_l}} = g^{β_l(L(s)+1)+ β_rR(s) +β_oO(s)}\)</span>，其中下标 <em>i</em> 代表对应变量的符号；指数 <em>i</em> 代表变量的值；以及未定义的变量多项式的值为 0。</p></li>
<li><p>设置证明：<span class="math inline">\((g^{L(s)},g^{R(s)},g^{O(s)},g^{α_lL(s)},g^{α_rR(s)},g^{α_oO(s)},g^{Z(s)},g^{h(s)})\)</span></p></li>
</ul></li>
<li><p>Verification：</p>
<ul>
<li><p>变量多项式约束检查：</p>
<p><span class="math inline">\(e(g^L,g^{β_l}) \cdot e(g^R, g^{β_r}) \cdot e(g^O,g^{β_o}) = e(g^Z,g) =&gt; e(g,g)^{(a \cdot l_a +1)β_l +Rβ_r + Oβ_o} = e(g,g)^{β_l(L+1)+ β_rR +β_oO}\)</span></p></li>
<li><p>有效计算检查：<span class="math inline">\(e(g^L,g^R) = e(g^t,g^h) \cdot e(g^O,g)\)</span></p></li>
</ul></li>
</ul>
<p><strong>变量一致性多项式的延展性</strong></p>
<p>而且 g<sup>β<sub>l</sub></sup>，g<sup>β<sub>r</sub></sup>，g<sup>β<sub>o</sub></sup>的存在允许我们在不同操作数的相同变量上使用不同的值。例如，如果我们有一个运算：</p>
<p><span class="math inline">\(a \times a = b\)</span></p>
<p>可以用多项式表示：</p>
<p><span class="math inline">\(l_a(x) = x, r_a(x) = x, o_a(x) = 0\)</span></p>
<p><span class="math inline">\(l_b(x) = 0, r_b(x) = 0, o_b(x) = x\)</span></p>
<p>尽管我们期待的输出是 <em>b</em>= <em>a</em>²，但我们可以设置不同的 <em>a</em> 值，例如：设置 <em>a</em>= 2 （左操作数中）, <em>a</em>= 5 （右操作数中）如下：</p>
<ul>
<li><p>Proving：</p>
<ul>
<li><p>…用 <em>a=2</em> 设置左操作数多项式：<span class="math inline">\(L(x) = 2l_a(x) + 10L_b(x)\)</span></p></li>
<li><p>用 <em>a=5</em> 设置右操作数多项式：<span class="math inline">\(R(x) = 2r_a(x) + 3 + 10r_b(x)\)</span></p></li>
<li><p>用 <em>b=10</em> 设置输出多项式：<span class="math inline">\(O(x) = 2o_a(x) +10o_b(x)\)</span></p></li>
<li><p>…计算加密值：</p>
<p><span class="math inline">\(g^{L(s)} = (g^{l_a(s)})^2 \cdot (g^{l_b(s)})^{10} = g^{2l_a(s)+10l_b(s)}\)</span></p>
<p><span class="math inline">\(g^{R(s)} = (g^{r_a(s)})^2 \cdot (g)^3 \cdot (g^{r_b(s)})^{10} = g^{2r_a(s)+3+10r_b(s)}\)</span></p>
<p><span class="math inline">\(g^{O(s)} = (g^{O_a(s)})^2 \cdot (g^{O_b(s)})^{10} = g^{2o_a(s)+10o_b(s)}\)</span></p></li>
<li><p>计算变量一致性多项式：</p>
<p>$g^{Z(s)} = (g<sup>{β_ll_a(s)+β_rr_a(s)+β_oo_a(s)})</sup>2 (g<sup>{β_r})</sup>3 (g^{β_ll_b(s)+ β_rr_b(s)+ β_oo_b(s)})^{10} $</p>
<p><span class="math inline">\(= g^{β_l(2l_a(s)+10l_b(s))+ β_r(2r_a(s)+3+10r_b(s)) + β_o(2o_a(s)+3+10o_b(s))}\)</span></p></li>
</ul></li>
<li><p>Verification：</p>
<ul>
<li><p>……变量值的一致性检查，应满足：</p>
<p><span class="math inline">\(e(g^L,g^{β_l}) \cdot e(g^R, g^{β_r}) \cdot e(g^O,g^{β_o}) = e(g^Z,g)\)</span></p></li>
</ul></li>
</ul>
<p>注意：多项式 o<sub>a</sub>(x)，l<sub>b</sub>(x)，r<sub>b</sub>(x) 其实可以被忽略掉的，因为这几项对于任何 <em>x</em> 的取值，计算结果都为 0，但是为了保持完整性我们依然要保留这几项。</p>
<blockquote>
<p>even@安比实验室：这种能力会危害到协议的可靠性。很显然，加密的 <em>β</em><sub>s</sub>不应该对 Prover 可见。</p>
</blockquote>
<p><strong>非延展性</strong></p>
<p>解决延展性问题的一个方法就是，在 setup 阶段将 <em>verification key</em> 中加密的 β<sub>s</sub> 项与随机秘密值 <em>γ</em>(gamma) 相乘使其与加密值 <em>Z</em>(<em>s</em>) 不兼容：</p>
<p><span class="math inline">\(g^{β_l \gamma}, g^{β_r\gamma}, g^{β_o\gamma}\)</span></p>
<p>相应的这种被修饰过的加密值，就能阻止使得修改加密值 <em>Z</em>(<em>s</em>) 变得不可行了，因为 <em>Z</em>(<em>s</em>) 中没有 <em>γ</em>，即：</p>
<p><span class="math inline">\(g^{Z(s)} \cdot g^{v&#39; \cdot β_l r} = g^{β_l(L(s)+v&#39;r)+β_rR(s) + β_oO(s)}\)</span></p>
<p>因为变值 <em>γ</em> 是随机的 prover 并不知道它的值。所以这个修改就需要我们用 <em>Z</em>(<em>s</em>) 乘以 <em>γ</em> 来平衡协议中的变量值一致性校验* 等式：</p>
<ul>
<li><p>Setup：</p>
<ul>
<li>…随机数 <span class="math inline">\(β_l\)</span>，<span class="math inline">\(β_r\)</span>，<span class="math inline">\(β_o\)</span>，<span class="math inline">\(γ\)</span></li>
<li>…设置 <em>verification key</em>：<span class="math inline">\((…, g^{β_l \gamma}, g^{β_r\gamma}, g^{β_o\gamma}, g^{\gamma})\)</span></li>
</ul></li>
<li><p>Proving：…</p></li>
<li><p>Verification：</p>
<ul>
<li><p>…变量值一致性检查应满足：</p>
<p><span class="math inline">\(e(g^L,g^{β_l\gamma}) \cdot e(g^R,g^{β_r\gamma}) \cdot e(g^O,g^{β_o\gamma}) = e(g^Z, g^{\gamma})\)</span></p></li>
</ul></li>
</ul>
<p>这里很重要的一点是我们排除了变量多项式为 0-阶的例子（即， <em>l</em>₁(<em>x</em>) = 1<em>x</em>⁰），否则就可以从 <em>proving key</em> 的<em>变量一致性多项式</em> 中揭露出加了密的 <em>β</em> 值</p>
<p><span class="math inline">\({g^{β_ll_i(s) +β_rr_i(s) + β_oo_i(s)}}_{i \in \{1,…,n\}}\)</span></p>
<p>这个例子中当操作数/输出中的任意两项为 0 时，即，对于 <em>l</em>₁(<em>x</em>) = 1, <em>r</em>₁(<em>s</em>) = 0, <em>o</em>₁(<em>s</em>) = 0 的例子，结果就是</p>
<p><span class="math inline">\(g^{β_ll_1(s) +β_rr_1(s) +β_oo_1(s)} = g^{β_l}\)</span></p>
<p>我们同样也可以通过<em>修饰</em> <em>α<sub>s</sub></em> 项来解决<em>变量多项式</em> 的延展性问题。但是这就没有必要了，因为对于<em>变量多项式</em> 的任何修改，都需要被映射到变量的<em>一致性多项式</em> 中，而一致性多项式是无法修改的。</p>
<h3 id="变量值一致性检查的优化">变量值一致性检查的优化</h3>
<p>现在<em>变量值一致性</em> 检查是有效的，但是这里在 <em>verification key</em> 中增加了 4 个昂贵的配对操作和 4 个新的项。文献 [<a href="#bd7c">Par+13</a>] 中的 Pinocchio 协议用了一个很聪明的方法优化，通过选择不同的生成元 <em>g</em> ，从而对每个操作数实行“移位”：</p>
<ul>
<li><p>Setup</p>
<ul>
<li>…选择随机值 <span class="math inline">\(β，γ，\rho_l,\rho_r\)</span> 并设置 <span class="math inline">\(\rho_o = \rho_l \cdot \rho_r\)</span></li>
<li>设置生成元 <span class="math inline">\(g_l=g^{\rho_l}, g_r=g^{\rho_r},g_o=g^{\rho_o}\)</span></li>
<li>设置 <em>proving key</em>：<span class="math inline">\((\{g^{s^k}\}_{k \in [d]},\{g_l^{l_i(s)}, g_r^{r_i(s)}, g_o^{o_i(s)}, g_l^{α_ll_i(s)}, g_r^{α_rr_i(s)}, g_o^{α_oo_i(s)}, g_l^{βl_i(s)}, g_r^{βr_i(s)}, g_o^{βo_i(s)}\}_{i \in [n]})\)</span></li>
<li>设置 <em>verification key</em>：<span class="math inline">\((g_o^{t(s)},g^{α_l},g^{α_r},g^{α_o},g^{βγ}，g^γ)\)</span></li>
</ul></li>
<li><p>Proving</p>
<ul>
<li><p>…分配变量值</p>
<p><span class="math inline">\(g^{Z(s)} = \prod_{i=1}^n{(g_l^{βl_i(s)} \cdot g_r^{βr_i(s)} \cdot g_o^{βo_i(s)})^{v_i}}\)</span></p></li>
</ul></li>
<li><p>Verification</p>
<ul>
<li><p>…变量多项式约束检查：</p>
<p><span class="math inline">\(e(g_l^{L&#39;},g) = e(g_l^L,g^{α_l})\)</span>，对 <span class="math inline">\(g_r^{R},g_o^{O}\)</span> 做同样的检查</p></li>
<li><p>变量值约束检查：</p>
<p><span class="math inline">\(e(g_l^L \cdot g_r^R \cdot g_o^O , g^{βγ}) = e(g^Z,g^γ)\)</span></p></li>
<li><p>有效运算检查：</p>
<p><span class="math inline">\(e(g_l^L , g_r^R) = e(g_o^t,g^h)e(g_o^O,g) =&gt; e(g,g)^{\rho_l\rho_rLR} = e(g,g)^{\rho_l\rho_rth+\rho_l\rho_rO}\)</span></p></li>
</ul></li>
</ul>
<p>生成元的这种随机化进一步增加了安全性，使得如 <strong>remark 4.1</strong>中描述的<em>可变多项式</em> 延展性无效。因为对于故意的修改，它必须要么是<em>ρ<sub>l</sub></em>, <em>ρ<sub>r</sub></em> 或者<em>ρ<sub>o</sub></em> 原始值的倍数要么就是不可直接用的加密值的倍数（假定,如上文所述我们不去处理可能曝光加密后的值的 0 阶可变多项式）。</p>
<p>这个优化使得 <em>verification key</em> 减少了两个项，并且去除了 verification 步骤中的两个配对运算。</p>
<p><em>注意：在 Jens Groth 2016年的 paper [<a href="#2923">Gro16</a>] 中有更进一步的改进。</em></p>
<blockquote>
<p>even@安比实验室:至此，通用 zk-SNARK 协议的已经几乎构造完成了，本文可以归纳为以下几点：</p>
<p>协议中是如何增加可变系数的和如何做加减乘除运算的</p>
<p>协议如何保证操作数和输出的不可替代性</p>
<p>协议如何保证跨操作数的可变一致性</p>
<p>协议如何处理非延展性变量和变量一致性</p>
<p>协议中变量值一致性检查优化</p>
</blockquote>
<p><strong>原文链接</strong></p>
<p>https://arxiv.org/pdf/1906.07221.pdf</p>
<p>https://medium.com/<span class="citation" data-cites="imolfar/why-and-how-zk-snark-works-5-variable-polynomials-3b4e06859e30">@imolfar/why-and-how-zk-snark-works-5-variable-polynomials-3b4e06859e30</span></p>
<p>https://medium.com/<span class="citation" data-cites="imolfar/why-and-how-zk-snark-works-6-verifiable-computation-protocol-1aa19f95a5cc">@imolfar/why-and-how-zk-snark-works-6-verifiable-computation-protocol-1aa19f95a5cc</span></p>
<p><strong>参考文献</strong></p>
<p>[Par+13] — Bryan Parno, Craig Gentry, Jon Howell, and Mariana Raykova. <em>Pinocchio: Nearly</em> <em>Practical Verifiable Computation</em>. Cryptology ePrint Archive, Report 2013/279. https://eprint.iacr.org/2013/279. 2013.</p>
<p>[Gen+12] — Rosario Gennaro, Craig Gentry, Bryan Parno, and Mariana Raykova. <em>Quadratic</em> <em>Span Programs and Succinct NIZKs without PCPs</em>. Cryptology ePrint Archive, Report 2012/215. https://eprint.iacr.org/2012/215. 2012.</p>
<p>[Gro16] — Jens Groth. <em>On the Size of Pairing-based Non-interactive Arguments</em>. Cryptology ePrint Archive, Report 2016/260. https://eprint.iacr.org/2016/260. 2016.</p>
<h1 id="section"></h1>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Maksym Petkus，翻译 & 注解：even@安比实验室（even@secbit.io）</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2020-12-15
      
        <a href="https://github.com/sec-bit/blog/commit/ede571e4199f32c9afa489307142e394449f4e44" title="add ariticles: Why-and-How-zk-SNARK-Works 3~5">
          (ede571e)
        </a>
        
          <br>add ariticles: Why-and-How-zk-SNARK-Works 3~5
        
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content">如需转载请注明文章作者和出处。</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://sec-bit.github.io/blog/tags/zero-knowledge-proof/">Zero Knowledge Proof</a>
          <a href="https://sec-bit.github.io/blog/tags/tutorials/">tutorials</a>
          <a href="https://sec-bit.github.io/blog/tags/zksnarks/">zkSNARKs</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/blog/2020/01/22/learn-zk-snark-from-zero-part-five/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">从零开始学习 zk-SNARK（五）——Pinocchio 协议</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/blog/2020/01/08/nizk-by-crs/">
            <span class="next-text nav-default">云中「秘密」：构建非交互式零知识证明</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "sec-bit/comments-for-secbit-blog"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:hi@secbit.io" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://twitter.com/SECBIT_IO" rel="me noopener" class="iconfont"
      title="twitter"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1264 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M1229.8616 18.043658c0 0-117.852626 63.135335-164.151872 67.344358-105.225559-164.151872-505.082682-92.598492-437.738325 223.078185C278.622548 312.675223 89.216542 47.506814 89.216542 47.506814s-117.852626 189.406006 75.762402 345.139833C127.097743 396.85567 55.544363 371.601535 55.544363 371.601535S26.081207 535.753407 253.368414 615.724832c-21.045112 29.463156-113.643603 8.418045-113.643603 8.418045s25.254134 143.10676 231.496229 180.987961c-143.10676 130.479693-387.230056 92.598492-370.393967 105.225559 206.242095 189.406006 1119.599946 231.496229 1128.01799-643.98042C1179.353331 249.539887 1263.533778 123.269217 1263.533778 123.269217s-130.479693 37.881201-138.897738 33.672179C1225.652577 98.015083 1229.8616 18.043658 1229.8616 18.043658"></path>
</svg>

    </a>
  
    <a href="https://github.com/sec-bit" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://www.zhihu.com/org/secbit/" rel="me noopener" class="iconfont"
      title="zhihu"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M351.791182 562.469462l192.945407 0c0-45.367257-21.3871-71.939449-21.3871-71.939449L355.897709 490.530013c3.977591-82.182744 7.541767-187.659007 8.816806-226.835262l159.282726 0c0 0-0.86367-67.402109-18.578124-67.402109s-279.979646 0-279.979646 0 16.850783-88.141456 39.318494-127.053698c0 0-83.60514-4.510734-112.121614 106.962104S81.344656 355.077018 76.80834 367.390461c-4.536316 12.313443 24.62791 5.832845 36.941354 0 12.313443-5.832845 68.050885-25.924439 84.252893-103.69571l86.570681 0c1.165546 49.28652 4.596691 200.335724 3.515057 226.835262L109.86113 490.530013c-25.275663 18.147312-33.701566 71.939449-33.701566 71.939449L279.868105 562.469462c-8.497535 56.255235-23.417339 128.763642-44.275389 167.210279-33.05279 60.921511-50.55235 116.65793-169.802314 212.576513 0 0-19.442818 14.257725 40.829917 9.073656 60.273758-5.185093 117.305683-20.739347 156.840094-99.807147 20.553105-41.107233 41.805128-93.250824 58.386782-146.138358l-0.055259 0.185218 167.855986 193.263655c0 0 22.035876-51.847855 5.832845-108.880803L371.045711 650.610918l-42.1244 31.157627-0.045025 0.151449c11.69946-41.020252 20.11206-81.5749 22.726607-116.858498C351.665315 564.212152 351.72876 563.345412 351.791182 562.469462z"></path>
  <path d="M584.918753 182.033893l0 668.840094 70.318532 0 28.807093 80.512708 121.875768-80.512708 153.600307 0L959.520453 182.033893 584.918753 182.033893zM887.150192 778.934538l-79.837326 0-99.578949 65.782216-23.537066-65.782216-24.855084 0L659.341766 256.673847l227.807403 0L887.149169 778.934538z"></path>
</svg>

    </a>


<a href="https://sec-bit.github.io/blog/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        SECBIT Labs
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/blog/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/blog/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/blog/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>






  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css"
    integrity="sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG"
    crossorigin="anonymous">

  
  <script defer
    src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js"
    integrity="sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1"
    crossorigin="anonymous"></script>

  
  <script defer
    src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js"
    integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
    crossorigin="anonymous" onload="renderMathInElement(document.body);">
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        
      });
    });
  </script>






  
    <script type="text/javascript" src="/blog/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/blog/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/blog/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  











  <script>
    $("#openSearch, #openSearchMobile").click(function(){
      $(".modal-dialog").addClass("visible");
    });

    $("#closeSearch").click(function(){
      $(".modal-dialog").removeClass("visible");
    });

    $(document).click(function(event) {
    
      if (!$(event.target).closest(".modal-content, #openSearch, #openSearchMobile").length) {
        $("body").find(".modal-dialog").removeClass("visible");
      }
    });
  </script>





</body>
</html>
